<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Large Language Model Message Class — LLMMessage • tidyllm</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Large Language Model Message Class — LLMMessage"><meta name="description" content="Large Language Model Message Class
Large Language Model Message Class"><meta property="og:description" content="Large Language Model Message Class
Large Language Model Message Class"><meta property="og:image" content="https://edubruell.github.io/tidyllm/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyllm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tidyllm.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tidyllm_classifiers.html">Classifying Texts with tidyllm</a></li>
    <li><a class="dropdown-item" href="../articles/tidyllm-pdfquestions.html">Structured Question Answering from PDFs</a></li>
    <li><a class="dropdown-item" href="../articles/tidyllm-synthetic-data.html">Generate Synthetic Data with tidyllm</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edubruell/tidyllm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Large Language Model Message Class</h1>
      <small class="dont-index">Source: <a href="https://github.com/edubruell/tidyllm/blob/HEAD/R/LLMMessage.R" class="external-link"><code>R/LLMMessage.R</code></a></small>
      <div class="d-none name"><code>LLMMessage.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Large Language Model Message Class</p>
<p>Large Language Model Message Class</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This class manages a history of messages and media interactions intended for use with large language  models.
It allows for adding messages, converting messages for API usage, and printing the history in a structured format.</p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>message_history</code></dt>
<dd><p>List to store all message interactions.</p></dd>


<dt><code>system_prompt</code></dt>
<dd><p>The system prompt used for a conversation</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-LLMMessage-new"><code>LLMMessage$new()</code></a></p></li>
<li><p><a href="#method-LLMMessage-clone_deep"><code>LLMMessage$clone_deep()</code></a></p></li>
<li><p><a href="#method-LLMMessage-add_message"><code>LLMMessage$add_message()</code></a></p></li>
<li><p><a href="#method-LLMMessage-to_api_format"><code>LLMMessage$to_api_format()</code></a></p></li>
<li><p><a href="#method-LLMMessage-has_image"><code>LLMMessage$has_image()</code></a></p></li>
<li><p><a href="#method-LLMMessage-remove_message"><code>LLMMessage$remove_message()</code></a></p></li>
<li><p><a href="#method-LLMMessage-print"><code>LLMMessage$print()</code></a></p></li>
<li><p><a href="#method-LLMMessage-clone"><code>LLMMessage$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-LLMMessage-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Initializes the LLMMessage object with an optional system prompt.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/LLMMessage.html">LLMMessage</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>system_prompt <span class="op">=</span> <span class="st">"You are a helpful assistant"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>system_prompt</code></dt>
<dd><p>A string that sets the initial system prompt.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A new LLMMessage object.</p>
</div>

</div><p></p><hr><a id="method-LLMMessage-clone_deep"></a><div class="section">
<h3 id="method-clone-deep-">Method <code>clone_deep()</code><a class="anchor" aria-label="anchor" href="#method-clone-deep-"></a></h3>
<p>Deep Clone of LLMMessage Object</p>
<p>This method creates a deep copy of the <code>LLMMessage</code> object. It ensures that
all internal states, including message histories and settings, are copied
so that the original object remains unchanged when mutations are applied
to the copy. This is particularly useful for maintaining immutability in
a tidyverse-like functional programming context where functions should
not have side effects on their inputs.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LLMMessage</span><span class="op">$</span><span class="fu">clone_deep</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>A new <code>LLMMessage</code> object that is a deep copy of the original.</p>
</div>

</div><p></p><hr><a id="method-LLMMessage-add_message"></a><div class="section">
<h3 id="method-add-message-">Method <code>add_message()</code><a class="anchor" aria-label="anchor" href="#method-add-message-"></a></h3>
<p>Add a message</p>
<p>Adds a message to the history. Optionally includes media.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LLMMessage</span><span class="op">$</span><span class="fu">add_message</span><span class="op">(</span><span class="va">role</span>, <span class="va">content</span>, media <span class="op">=</span> <span class="cn">NULL</span>, json <span class="op">=</span> <span class="cn">FALSE</span>, meta <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>role</code></dt>
<dd><p>The role of the message sender (e.g., "user", "assistant").</p></dd>


<dt><code>content</code></dt>
<dd><p>The textual content of the message.</p></dd>


<dt><code>media</code></dt>
<dd><p>Optional; media content to attach to the message.</p></dd>


<dt><code>json</code></dt>
<dd><p>Is the message a raw string that contains a json response?</p></dd>


<dt><code>meta</code></dt>
<dd><p>Optional, metadata returned by an API</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-LLMMessage-to_api_format"></a><div class="section">
<h3 id="method-to-api-format-">Method <code>to_api_format()</code><a class="anchor" aria-label="anchor" href="#method-to-api-format-"></a></h3>
<p>Convert to API format</p>
<p>Converts the message history to a format suitable for various API calls.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LLMMessage</span><span class="op">$</span><span class="fu">to_api_format</span><span class="op">(</span></span>
<span>  <span class="va">api_type</span>,</span>
<span>  cgpt_image_detail <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  no_system <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>api_type</code></dt>
<dd><p>The type of API (e.g., "claude","groq","openai").</p></dd>


<dt><code>cgpt_image_detail</code></dt>
<dd><p>Specific option for ChatGPT API (imagedetail - set to auto)</p></dd>


<dt><code>no_system</code></dt>
<dd><p>Without system prompt (default: FALSE)</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A message history in the target API format</p>
</div>

</div><p></p><hr><a id="method-LLMMessage-has_image"></a><div class="section">
<h3 id="method-has-image-">Method <code>has_image()</code><a class="anchor" aria-label="anchor" href="#method-has-image-"></a></h3>
<p>Simple helper method to determine whether the message history contains
an image.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LLMMessage</span><span class="op">$</span><span class="fu">has_image</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>Returns TRUE if the message hisotry contains images</p>
</div>

</div><p></p><hr><a id="method-LLMMessage-remove_message"></a><div class="section">
<h3 id="method-remove-message-">Method <code>remove_message()</code><a class="anchor" aria-label="anchor" href="#method-remove-message-"></a></h3>
<p>Remove a Message by Index</p>
<p>Removes a message from the message history at the specified index.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LLMMessage</span><span class="op">$</span><span class="fu">remove_message</span><span class="op">(</span><span class="va">index</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>index</code></dt>
<dd><p>A positive integer indicating the position of the message to remove.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>The <code>LLMMessage</code> object, invisibly.</p>
</div>

</div><p></p><hr><a id="method-LLMMessage-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Prints the current message history in a structured format.</p>
<p>By default, this function respects the <code>tidyllm_print_metadata</code> option.
If the option is set to <code>TRUE</code>, metadata for each message (if available) will be printed.</p>
<p>Users can override the default behavior by explicitly passing a value to the <code>.meta</code> parameter.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LLMMessage</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span>.meta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"tidyllm_print_metadata"</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>.meta</code></dt>
<dd><p>Logical; if <code>TRUE</code>, prints metadata for each message.
Defaults to the value of <code>getOption("tidyllm_print_metadata", FALSE)</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-LLMMessage-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LLMMessage</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eduard Brüll.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

